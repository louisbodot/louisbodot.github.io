const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["ResourceCenterApp.v1.DUrtOQxF.js","index.v1.Cz7k5fdf.js","typeof.v1.DCF4SmM_.js","flow-host.styl.v1.ITJz18xx.js","use-selector-element-monitoring.v1.Dc7PaS1l.js","flow-condition-types.v1.ByaBzkSZ.js","roots.v1.Bh6iSUOg.js","stylesheets.v1.D0y-bLxh.js","Frame.v1.DuJ7h2WL.js","unsupportedIterableToArray.v1.Bh-jFtrU.js","use-window-resize.v1.CtZrOEiR.js","logomark.v1.Btw6w3fw.js","ChecklistUI.v1.C-qcLjVA.js","FlowChrome.v1.DcQDR7k0.js","use-element-rect.v1.BpsDE2gh.js","BannerApp.v1.CdCRjG8y.js","implicit-tracking.v1.C-WeXLGI.js","DebuggerUI.v1.BTXD64JU.js","lodash.v1.pSe8OIzF.js","ui.v1.DH9JjGAA.js"])))=>i.map(i=>d[i]);
(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4a740cc8-03bf-421a-a4d9-3af292d0aff7",e._sentryDebugIdIdentifier="sentry-dbid-4a740cc8-03bf-421a-a4d9-3af292d0aff7")}catch{}})();var Kr=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};Kr.SENTRY_RELEASE={id:"1044026a4bc3837a5f9d09a0c4cd30ef77b9d5fa"};var J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j=function(e){return e&&e.Math===Math&&e},T=j(typeof globalThis=="object"&&globalThis)||j(typeof window=="object"&&window)||j(typeof self=="object"&&self)||j(typeof J=="object"&&J)||j(typeof J=="object"&&J)||function(){return this}()||Function("return this")(),Je={},N=function(e){try{return!!e()}catch{return!0}},Vr=N,L=!Vr(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),zr=N,Xe=!zr(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Yr=Xe,X=Function.prototype.call,_=Yr?X.bind(X):function(){return X.apply(X,arguments)},Xt={},Qt={}.propertyIsEnumerable,Zt=Object.getOwnPropertyDescriptor,Jr=Zt&&!Qt.call({1:2},1);Xt.f=Jr?function(t){var r=Zt(this,t);return!!r&&r.enumerable}:Qt;var qt=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},er=Xe,tr=Function.prototype,Be=tr.call,Xr=er&&tr.bind.bind(Be,Be),R=er?Xr:function(e){return function(){return Be.apply(e,arguments)}},rr=R,Qr=rr({}.toString),Zr=rr("".slice),ge=function(e){return Zr(Qr(e),8,-1)},qr=R,es=N,ts=ge,Se=Object,rs=qr("".split),ss=es(function(){return!Se("z").propertyIsEnumerable(0)})?function(e){return ts(e)==="String"?rs(e,""):Se(e)}:Se,Qe=function(e){return e==null},is=Qe,ns=TypeError,sr=function(e){if(is(e))throw new ns("Can't call method on "+e);return e},os=ss,as=sr,Ze=function(e){return os(as(e))},pe=typeof document=="object"&&document.all,m=typeof pe>"u"&&pe!==void 0?function(e){return typeof e=="function"||e===pe}:function(e){return typeof e=="function"},cs=m,K=function(e){return typeof e=="object"?e!==null:cs(e)},me=T,ls=m,hs=function(e){return ls(e)?e:void 0},ir=function(e,t){return arguments.length<2?hs(me[e]):me[e]&&me[e][t]},us=R,nr=us({}.isPrototypeOf),ds=T,ht=ds.navigator,ut=ht&&ht.userAgent,or=ut?String(ut):"",ar=T,Ie=or,dt=ar.process,ft=ar.Deno,Et=dt&&dt.versions||ft&&ft.version,vt=Et&&Et.v8,w,ue;vt&&(w=vt.split("."),ue=w[0]>0&&w[0]<4?1:+(w[0]+w[1]));!ue&&Ie&&(w=Ie.match(/Edge\/(\d+)/),(!w||w[1]>=74)&&(w=Ie.match(/Chrome\/(\d+)/),w&&(ue=+w[1])));var cr=ue,gt=cr,fs=N,Es=T,vs=Es.String,lr=!!Object.getOwnPropertySymbols&&!fs(function(){var e=Symbol("symbol detection");return!vs(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&gt&&gt<41}),gs=lr,hr=gs&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ts=ir,Ss=m,ps=nr,ms=hr,Is=Object,ur=ms?function(e){return typeof e=="symbol"}:function(e){var t=Ts("Symbol");return Ss(t)&&ps(t.prototype,Is(e))},ws=String,qe=function(e){try{return ws(e)}catch{return"Object"}},Cs=m,ys=qe,bs=TypeError,V=function(e){if(Cs(e))return e;throw new bs(ys(e)+" is not a function")},Rs=V,Os=Qe,et=function(e,t){var r=e[t];return Os(r)?void 0:Rs(r)},we=_,Ce=m,ye=K,ks=TypeError,Ns=function(e,t){var r,s;if(t==="string"&&Ce(r=e.toString)&&!ye(s=we(r,e))||Ce(r=e.valueOf)&&!ye(s=we(r,e))||t!=="string"&&Ce(r=e.toString)&&!ye(s=we(r,e)))return s;throw new ks("Can't convert object to primitive value")},dr={exports:{}},Tt=T,Us=Object.defineProperty,tt=function(e,t){try{Us(Tt,e,{value:t,configurable:!0,writable:!0})}catch{Tt[e]=t}return t},Ls=T,_s=tt,St="__core-js_shared__",pt=dr.exports=Ls[St]||_s(St,{});(pt.versions||(pt.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var rt=dr.exports,mt=rt,fr=function(e,t){return mt[e]||(mt[e]=t||{})},As=sr,$s=Object,Ds=function(e){return $s(As(e))},Ps=R,Ms=Ds,js=Ps({}.hasOwnProperty),A=Object.hasOwn||function(t,r){return js(Ms(t),r)},Bs=R,xs=0,Hs=Math.random(),Gs=Bs(1 .toString),Er=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Gs(++xs+Hs,36)},Fs=T,Ws=fr,It=A,Ks=Er,Vs=lr,zs=hr,M=Fs.Symbol,be=Ws("wks"),Ys=zs?M.for||M:M&&M.withoutSetter||Ks,$=function(e){return It(be,e)||(be[e]=Vs&&It(M,e)?M[e]:Ys("Symbol."+e)),be[e]},Js=_,wt=K,Ct=ur,Xs=et,Qs=Ns,Zs=$,qs=TypeError,ei=Zs("toPrimitive"),ti=function(e,t){if(!wt(e)||Ct(e))return e;var r=Xs(e,ei),s;if(r){if(t===void 0&&(t="default"),s=Js(r,e,t),!wt(s)||Ct(s))return s;throw new qs("Can't convert object to primitive value")}return t===void 0&&(t="number"),Qs(e,t)},ri=ti,si=ur,vr=function(e){var t=ri(e,"string");return si(t)?t:t+""},ii=T,yt=K,xe=ii.document,ni=yt(xe)&&yt(xe.createElement),oi=function(e){return ni?xe.createElement(e):{}},ai=L,ci=N,li=oi,gr=!ai&&!ci(function(){return Object.defineProperty(li("div"),"a",{get:function(){return 7}}).a!==7}),hi=L,ui=_,di=Xt,fi=qt,Ei=Ze,vi=vr,gi=A,Ti=gr,bt=Object.getOwnPropertyDescriptor;Je.f=hi?bt:function(t,r){if(t=Ei(t),r=vi(r),Ti)try{return bt(t,r)}catch{}if(gi(t,r))return fi(!ui(di.f,t,r),t[r])};var Te={},Si=L,pi=N,mi=Si&&pi(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ii=K,wi=String,Ci=TypeError,z=function(e){if(Ii(e))return e;throw new Ci(wi(e)+" is not an object")},yi=L,bi=gr,Ri=mi,Q=z,Rt=vr,Oi=TypeError,Re=Object.defineProperty,ki=Object.getOwnPropertyDescriptor,Oe="enumerable",ke="configurable",Ne="writable";Te.f=yi?Ri?function(t,r,s){if(Q(t),r=Rt(r),Q(s),typeof t=="function"&&r==="prototype"&&"value"in s&&Ne in s&&!s[Ne]){var i=ki(t,r);i&&i[Ne]&&(t[r]=s.value,s={configurable:ke in s?s[ke]:i[ke],enumerable:Oe in s?s[Oe]:i[Oe],writable:!1})}return Re(t,r,s)}:Re:function(t,r,s){if(Q(t),r=Rt(r),Q(s),bi)try{return Re(t,r,s)}catch{}if("get"in s||"set"in s)throw new Oi("Accessors not supported");return"value"in s&&(t[r]=s.value),t};var Ni=L,Ui=Te,Li=qt,Tr=Ni?function(e,t,r){return Ui.f(e,t,Li(1,r))}:function(e,t,r){return e[t]=r,e},Sr={exports:{}},He=L,_i=A,pr=Function.prototype,Ai=He&&Object.getOwnPropertyDescriptor,st=_i(pr,"name"),$i=st&&function(){}.name==="something",Di=st&&(!He||He&&Ai(pr,"name").configurable),Pi={EXISTS:st,PROPER:$i,CONFIGURABLE:Di},Mi=R,ji=m,Ge=rt,Bi=Mi(Function.toString);ji(Ge.inspectSource)||(Ge.inspectSource=function(e){return Bi(e)});var mr=Ge.inspectSource,xi=T,Hi=m,Ot=xi.WeakMap,Gi=Hi(Ot)&&/native code/.test(String(Ot)),Fi=fr,Wi=Er,kt=Fi("keys"),Ki=function(e){return kt[e]||(kt[e]=Wi(e))},Ir={},Vi=Gi,wr=T,zi=K,Yi=Tr,Ue=A,Le=rt,Ji=Ki,Xi=Ir,Nt="Object already initialized",Fe=wr.TypeError,Qi=wr.WeakMap,de,W,fe,Zi=function(e){return fe(e)?W(e):de(e,{})},qi=function(e){return function(t){var r;if(!zi(t)||(r=W(t)).type!==e)throw new Fe("Incompatible receiver, "+e+" required");return r}};if(Vi||Le.state){var C=Le.state||(Le.state=new Qi);C.get=C.get,C.has=C.has,C.set=C.set,de=function(e,t){if(C.has(e))throw new Fe(Nt);return t.facade=e,C.set(e,t),t},W=function(e){return C.get(e)||{}},fe=function(e){return C.has(e)}}else{var P=Ji("state");Xi[P]=!0,de=function(e,t){if(Ue(e,P))throw new Fe(Nt);return t.facade=e,Yi(e,P,t),t},W=function(e){return Ue(e,P)?e[P]:{}},fe=function(e){return Ue(e,P)}}var en={set:de,get:W,has:fe,enforce:Zi,getterFor:qi},it=R,tn=N,rn=m,Z=A,We=L,sn=Pi.CONFIGURABLE,nn=mr,Cr=en,on=Cr.enforce,an=Cr.get,Ut=String,oe=Object.defineProperty,cn=it("".slice),ln=it("".replace),hn=it([].join),un=We&&!tn(function(){return oe(function(){},"length",{value:8}).length!==8}),dn=String(String).split("String"),fn=Sr.exports=function(e,t,r){cn(Ut(t),0,7)==="Symbol("&&(t="["+ln(Ut(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Z(e,"name")||sn&&e.name!==t)&&(We?oe(e,"name",{value:t,configurable:!0}):e.name=t),un&&r&&Z(r,"arity")&&e.length!==r.arity&&oe(e,"length",{value:r.arity});try{r&&Z(r,"constructor")&&r.constructor?We&&oe(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var s=on(e);return Z(s,"source")||(s.source=hn(dn,typeof t=="string"?t:"")),e};Function.prototype.toString=fn(function(){return rn(this)&&an(this).source||nn(this)},"toString");var En=Sr.exports,vn=m,gn=Te,Tn=En,Sn=tt,pn=function(e,t,r,s){s||(s={});var i=s.enumerable,n=s.name!==void 0?s.name:t;if(vn(r)&&Tn(r,n,s),s.global)i?e[t]=r:Sn(t,r);else{try{s.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:gn.f(e,t,{value:r,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e},yr={},mn=Math.ceil,In=Math.floor,wn=Math.trunc||function(t){var r=+t;return(r>0?In:mn)(r)},Cn=wn,br=function(e){var t=+e;return t!==t||t===0?0:Cn(t)},yn=br,bn=Math.max,Rn=Math.min,On=function(e,t){var r=yn(e);return r<0?bn(r+t,0):Rn(r,t)},kn=br,Nn=Math.min,Un=function(e){var t=kn(e);return t>0?Nn(t,9007199254740991):0},Ln=Un,Rr=function(e){return Ln(e.length)},_n=Ze,An=On,$n=Rr,Lt=function(e){return function(t,r,s){var i=_n(t),n=$n(i);if(n===0)return!e&&-1;var o=An(s,n),a;if(e&&r!==r){for(;n>o;)if(a=i[o++],a!==a)return!0}else for(;n>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},Dn={includes:Lt(!0),indexOf:Lt(!1)},Pn=R,_e=A,Mn=Ze,jn=Dn.indexOf,Bn=Ir,_t=Pn([].push),xn=function(e,t){var r=Mn(e),s=0,i=[],n;for(n in r)!_e(Bn,n)&&_e(r,n)&&_t(i,n);for(;t.length>s;)_e(r,n=t[s++])&&(~jn(i,n)||_t(i,n));return i},Hn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Gn=xn,Fn=Hn,Wn=Fn.concat("length","prototype");yr.f=Object.getOwnPropertyNames||function(t){return Gn(t,Wn)};var Or={};Or.f=Object.getOwnPropertySymbols;var Kn=ir,Vn=R,zn=yr,Yn=Or,Jn=z,Xn=Vn([].concat),Qn=Kn("Reflect","ownKeys")||function(t){var r=zn.f(Jn(t)),s=Yn.f;return s?Xn(r,s(t)):r},At=A,Zn=Qn,qn=Je,eo=Te,to=function(e,t,r){for(var s=Zn(t),i=eo.f,n=qn.f,o=0;o<s.length;o++){var a=s[o];!At(e,a)&&!(r&&At(r,a))&&i(e,a,n(t,a))}},ro=N,so=m,io=/#|\.prototype\./,Y=function(e,t){var r=oo[no(e)];return r===co?!0:r===ao?!1:so(t)?ro(t):!!t},no=Y.normalize=function(e){return String(e).replace(io,".").toLowerCase()},oo=Y.data={},ao=Y.NATIVE="N",co=Y.POLYFILL="P",kr=Y,q=T,lo=Je.f,ho=Tr,uo=pn,fo=tt,Eo=to,vo=kr,go=function(e,t){var r=e.target,s=e.global,i=e.stat,n,o,a,c,l,u;if(s?o=q:i?o=q[r]||fo(r,{}):o=q[r]&&q[r].prototype,o)for(a in t){if(l=t[a],e.dontCallGetSet?(u=lo(o,a),c=u&&u.value):c=o[a],n=vo(s?a:r+(i?".":"#")+a,e.forced),!n&&c!==void 0){if(typeof l==typeof c)continue;Eo(l,c)}(e.sham||c&&c.sham)&&ho(l,"sham",!0),uo(o,a,l,e)}},Nr={},$t=V,To=TypeError,So=function(e){var t,r;this.promise=new e(function(s,i){if(t!==void 0||r!==void 0)throw new To("Bad Promise constructor");t=s,r=i}),this.resolve=$t(t),this.reject=$t(r)};Nr.f=function(e){return new So(e)};var po=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},mo=ge,Io=R,wo=function(e){if(mo(e)==="Function")return Io(e)},Dt=wo,Co=V,yo=Xe,bo=Dt(Dt.bind),Ro=function(e,t){return Co(e),t===void 0?e:yo?bo(e,t):function(){return e.apply(t,arguments)}},Ur={},Oo=$,ko=Ur,No=Oo("iterator"),Uo=Array.prototype,Lo=function(e){return e!==void 0&&(ko.Array===e||Uo[No]===e)},_o=$,Ao=_o("toStringTag"),Lr={};Lr[Ao]="z";var $o=String(Lr)==="[object z]",Do=$o,Po=m,ae=ge,Mo=$,jo=Mo("toStringTag"),Bo=Object,xo=ae(function(){return arguments}())==="Arguments",Ho=function(e,t){try{return e[t]}catch{}},Go=Do?ae:function(e){var t,r,s;return e===void 0?"Undefined":e===null?"Null":typeof(r=Ho(t=Bo(e),jo))=="string"?r:xo?ae(t):(s=ae(t))==="Object"&&Po(t.callee)?"Arguments":s},Fo=Go,Pt=et,Wo=Qe,Ko=Ur,Vo=$,zo=Vo("iterator"),_r=function(e){if(!Wo(e))return Pt(e,zo)||Pt(e,"@@iterator")||Ko[Fo(e)]},Yo=_,Jo=V,Xo=z,Qo=qe,Zo=_r,qo=TypeError,ea=function(e,t){var r=arguments.length<2?Zo(e):t;if(Jo(r))return Xo(Yo(r,e));throw new qo(Qo(e)+" is not iterable")},ta=_,Mt=z,ra=et,sa=function(e,t,r){var s,i;Mt(e);try{if(s=ra(e,"return"),!s){if(t==="throw")throw r;return r}s=ta(s,e)}catch(n){i=!0,s=n}if(t==="throw")throw r;if(i)throw s;return Mt(s),r},ia=Ro,na=_,oa=z,aa=qe,ca=Lo,la=Rr,jt=nr,ha=ea,ua=_r,Bt=sa,da=TypeError,ce=function(e,t){this.stopped=e,this.result=t},xt=ce.prototype,fa=function(e,t,r){var s=r&&r.that,i=!!(r&&r.AS_ENTRIES),n=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),c=ia(t,s),l,u,d,O,E,D,at,ct=function(p){return l&&Bt(l,"normal",p),new ce(!0,p)},lt=function(p){return i?(oa(p),a?c(p[0],p[1],ct):c(p[0],p[1])):a?c(p,ct):c(p)};if(n)l=e.iterator;else if(o)l=e;else{if(u=ua(e),!u)throw new da(aa(e)+" is not iterable");if(ca(u)){for(d=0,O=la(e);O>d;d++)if(E=lt(e[d]),E&&jt(xt,E))return E;return new ce(!1)}l=ha(e,u)}for(D=n?e.next:l.next;!(at=na(D,l)).done;){try{E=lt(at.value)}catch(p){Bt(l,"throw",p)}if(typeof E=="object"&&E&&jt(xt,E))return E}return new ce(!1)},Ea=T,Ar=Ea.Promise,va=$,$r=va("iterator"),Dr=!1;try{var ga=0,Ht={next:function(){return{done:!!ga++}},return:function(){Dr=!0}};Ht[$r]=function(){return this},Array.from(Ht,function(){throw 2})}catch{}var Ta=function(e,t){try{if(!t&&!Dr)return!1}catch{return!1}var r=!1;try{var s={};s[$r]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch{}return r},B=T,Sa=or,pa=ge,ee=function(e){return Sa.slice(0,e.length)===e},ma=function(){return ee("Bun/")?"BUN":ee("Cloudflare-Workers")?"CLOUDFLARE":ee("Deno/")?"DENO":ee("Node.js/")?"NODE":B.Bun&&typeof Bun.version=="string"?"BUN":B.Deno&&typeof Deno.version=="object"?"DENO":pa(B.process)==="process"?"NODE":B.window&&B.document?"BROWSER":"REST"}(),Ia=T,H=Ar,wa=m,Ca=kr,ya=mr,ba=$,Gt=ma,Ae=cr;H&&H.prototype;var Ra=ba("species"),Ke=!1,Pr=wa(Ia.PromiseRejectionEvent),Oa=Ca("Promise",function(){var e=ya(H),t=e!==String(H);if(!t&&Ae===66)return!0;if(!Ae||Ae<51||!/native code/.test(e)){var r=new H(function(n){n(1)}),s=function(n){n(function(){},function(){})},i=r.constructor={};if(i[Ra]=s,Ke=r.then(function(){})instanceof s,!Ke)return!0}return!t&&(Gt==="BROWSER"||Gt==="DENO")&&!Pr}),ka={CONSTRUCTOR:Oa,REJECTION_EVENT:Pr,SUBCLASSING:Ke},Na=Ar,Ua=Ta,La=ka.CONSTRUCTOR,_a=La||!Ua(function(e){Na.all(e).then(void 0,function(){})}),Aa=go,$a=_,Da=V,Pa=Nr,Ma=po,ja=fa,Ba=_a;Aa({target:"Promise",stat:!0,forced:Ba},{allSettled:function(t){var r=this,s=Pa.f(r),i=s.resolve,n=s.reject,o=Ma(function(){var a=Da(r.resolve),c=[],l=0,u=1;ja(t,function(d){var O=l++,E=!1;u++,$a(a,r,d).then(function(D){E||(E=!0,c[O]={status:"fulfilled",value:D},--u||i(c))},function(D){E||(E=!0,c[O]={status:"rejected",reason:D},--u||i(c))})}),--u||i(c)});return o.error&&n(o.value),s.promise}});const xa="modulepreload",Ha=function(e){return new URL("./",import.meta.url).toString()+e},Ft={},U=function(t,r,s){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(r.map(c=>{if(c=Ha(c),c in Ft)return;Ft[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":xa,l||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),l)return new Promise((O,E)=>{d.addEventListener("load",O),d.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};var G=e=>typeof e=="function"?e:function(){return e},Ga=typeof self<"u"?self:null,x=typeof window<"u"?window:null,F=Ga||x||F,Fa="2.0.0",b={connecting:0,open:1,closing:2,closed:3},Wa=1e4,Ka=1e3,S={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},k={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},Ve={longpoll:"longpoll",websocket:"websocket"},Va={complete:4},te=class{constructor(e,t,r,s){this.channel=e,this.event=t,this.payload=r||function(){return{}},this.receivedResp=null,this.timeout=s,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:t,_ref:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}},Mr=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}},za=class{constructor(e,t,r){this.state=S.closed,this.topic=e,this.params=G(t||{}),this.socket=r,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new te(this,k.join,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new Mr(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=S.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=S.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=S.closed,this.socket.remove(this)}),this.onError(s=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,s),this.isJoining()&&this.joinPush.reset(),this.state=S.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new te(this,k.leave,G({}),this.timeout).send(),this.state=S.errored,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(k.reply,(s,i)=>{this.trigger(this.replyEventName(i),s)})}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(k.close,e)}onError(e){return this.on(k.error,t=>e(t))}on(e,t){let r=this.bindingRef++;return this.bindings.push({event:e,ref:r,callback:t}),r}off(e,t){this.bindings=this.bindings.filter(r=>!(r.event===e&&(typeof t>"u"||t===r.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(t=t||{},!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let s=new te(this,e,function(){return t},r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=S.leaving;let t=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(k.close,"leave")},r=new te(this,k.leave,G({}),e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e,t,r,s){return this.topic!==e?!1:s&&s!==this.joinRef()?(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:r,joinRef:s}),!1):!0}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=S.joining,this.joinPush.resend(e))}trigger(e,t,r,s){let i=this.onMessage(e,t,r,s);if(t&&!i)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let n=this.bindings.filter(o=>o.event===e);for(let o=0;o<n.length;o++)n[o].callback(i,r,s||this.joinRef())}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===S.closed}isErrored(){return this.state===S.errored}isJoined(){return this.state===S.joined}isJoining(){return this.state===S.joining}isLeaving(){return this.state===S.leaving}},Ee=class{static request(e,t,r,s,i,n,o){if(F.XDomainRequest){let a=new F.XDomainRequest;return this.xdomainRequest(a,e,t,s,i,n,o)}else{let a=new F.XMLHttpRequest;return this.xhrRequest(a,e,t,r,s,i,n,o)}}static xdomainRequest(e,t,r,s,i,n,o){return e.timeout=i,e.open(t,r),e.onload=()=>{let a=this.parseJSON(e.responseText);o&&o(a)},n&&(e.ontimeout=n),e.onprogress=()=>{},e.send(s),e}static xhrRequest(e,t,r,s,i,n,o,a){return e.open(t,r,!0),e.timeout=n,e.setRequestHeader("Content-Type",s),e.onerror=()=>a&&a(null),e.onreadystatechange=()=>{if(e.readyState===Va.complete&&a){let c=this.parseJSON(e.responseText);a(c)}},o&&(e.ontimeout=o),e.send(i),e}static parseJSON(e){if(!e||e==="")return null;try{return JSON.parse(e)}catch{return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,t){let r=[];for(var s in e){if(!Object.prototype.hasOwnProperty.call(e,s))continue;let i=t?`${t}[${s}]`:s,n=e[s];typeof n=="object"?r.push(this.serialize(n,i)):r.push(encodeURIComponent(i)+"="+encodeURIComponent(n))}return r.join("&")}static appendParams(e,t){if(Object.keys(t).length===0)return e;let r=e.match(/\?/)?"&":"?";return`${e}${r}${this.serialize(t)}`}},$e=class{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=b.connecting,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+Ve.websocket),"$1/"+Ve.longpoll)}endpointURL(){return Ee.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(e,t,r){this.close(e,t,r),this.readyState=b.connecting}ontimeout(){this.onerror("timeout"),this.closeAndRetry(1005,"timeout",!1)}isActive(){return this.readyState===b.open||this.readyState===b.connecting}poll(){this.ajax("GET",null,()=>this.ontimeout(),e=>{if(e){var{status:t,token:r,messages:s}=e;this.token=r}else t=0;switch(t){case 200:s.forEach(i=>{setTimeout(()=>this.onmessage({data:i}),0)}),this.poll();break;case 204:this.poll();break;case 410:this.readyState=b.open,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error(`unhandled poll status ${t}`)}})}send(e){this.ajax("POST",e,()=>this.onerror("timeout"),t=>{(!t||t.status!==200)&&(this.onerror(t&&t.status),this.closeAndRetry(1011,"internal server error",!1))})}close(e,t,r){for(let i of this.reqs)i.abort();this.readyState=b.closed;let s=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:e,reason:t,wasClean:r});typeof CloseEvent<"u"?this.onclose(new CloseEvent("close",s)):this.onclose(s)}ajax(e,t,r,s){let i,n=()=>{this.reqs.delete(i),r()};i=Ee.request(e,this.endpointURL(),"application/json",t,this.timeout,n,o=>{this.reqs.delete(i),this.isActive()&&s(o)}),this.reqs.add(i)}},re={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(e,t){if(e.payload.constructor===ArrayBuffer)return t(this.binaryEncode(e));{let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}},decode(e,t){if(e.constructor===ArrayBuffer)return t(this.binaryDecode(e));{let[r,s,i,n,o]=JSON.parse(e);return t({join_ref:r,ref:s,topic:i,event:n,payload:o})}},binaryEncode(e){let{join_ref:t,ref:r,event:s,topic:i,payload:n}=e,o=this.META_LENGTH+t.length+r.length+i.length+s.length,a=new ArrayBuffer(this.HEADER_LENGTH+o),c=new DataView(a),l=0;c.setUint8(l++,this.KINDS.push),c.setUint8(l++,t.length),c.setUint8(l++,r.length),c.setUint8(l++,i.length),c.setUint8(l++,s.length),Array.from(t,d=>c.setUint8(l++,d.charCodeAt(0))),Array.from(r,d=>c.setUint8(l++,d.charCodeAt(0))),Array.from(i,d=>c.setUint8(l++,d.charCodeAt(0))),Array.from(s,d=>c.setUint8(l++,d.charCodeAt(0)));var u=new Uint8Array(a.byteLength+n.byteLength);return u.set(new Uint8Array(a),0),u.set(new Uint8Array(n),a.byteLength),u.buffer},binaryDecode(e){let t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this.decodePush(e,t,s);case this.KINDS.reply:return this.decodeReply(e,t,s);case this.KINDS.broadcast:return this.decodeBroadcast(e,t,s)}},decodePush(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=t.getUint8(3),o=this.HEADER_LENGTH+this.META_LENGTH-1,a=r.decode(e.slice(o,o+s));o=o+s;let c=r.decode(e.slice(o,o+i));o=o+i;let l=r.decode(e.slice(o,o+n));o=o+n;let u=e.slice(o,e.byteLength);return{join_ref:a,ref:null,topic:c,event:l,payload:u}},decodeReply(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=t.getUint8(3),o=t.getUint8(4),a=this.HEADER_LENGTH+this.META_LENGTH,c=r.decode(e.slice(a,a+s));a=a+s;let l=r.decode(e.slice(a,a+i));a=a+i;let u=r.decode(e.slice(a,a+n));a=a+n;let d=r.decode(e.slice(a,a+o));a=a+o;let O=e.slice(a,e.byteLength),E={status:d,response:O};return{join_ref:c,ref:l,topic:u,event:k.reply,payload:E}},decodeBroadcast(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=this.HEADER_LENGTH+2,o=r.decode(e.slice(n,n+s));n=n+s;let a=r.decode(e.slice(n,n+i));n=n+i;let c=e.slice(n,e.byteLength);return{join_ref:null,ref:null,topic:o,event:a,payload:c}}},Ya=class{constructor(e,t={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=t.timeout||Wa,this.transport=t.transport||F.WebSocket||$e,this.establishedConnections=0,this.defaultEncoder=re.encode.bind(re),this.defaultDecoder=re.decode.bind(re),this.closeWasClean=!1,this.binaryType=t.binaryType||"arraybuffer",this.connectClock=1,this.transport!==$e?(this.encode=t.encode||this.defaultEncoder,this.decode=t.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let r=null;x&&x.addEventListener&&(x.addEventListener("pagehide",s=>{this.conn&&(this.disconnect(),r=this.connectClock)}),x.addEventListener("pageshow",s=>{r===this.connectClock&&(r=null,this.connect())})),this.heartbeatIntervalMs=t.heartbeatIntervalMs||3e4,this.rejoinAfterMs=s=>t.rejoinAfterMs?t.rejoinAfterMs(s):[1e3,2e3,5e3][s-1]||1e4,this.reconnectAfterMs=s=>t.reconnectAfterMs?t.reconnectAfterMs(s):[10,50,100,150,200,250,500,1e3,2e3][s-1]||5e3,this.logger=t.logger||null,this.longpollerTimeout=t.longpollerTimeout||2e4,this.params=G(t.params||{}),this.endPoint=`${e}/${Ve.websocket}`,this.vsn=t.vsn||Fa,this.heartbeatTimeoutTimer=null,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new Mr(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}getLongPollTransport(){return $e}replaceTransport(e){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.sendBuffer=[],this.conn&&(this.conn.close(),this.conn=null),this.transport=e}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=Ee.appendParams(Ee.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return e.charAt(0)!=="/"?e:e.charAt(1)==="/"?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,t,r){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,r)}connect(e){e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=G(e)),!this.conn&&(this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=t=>this.onConnError(t),this.conn.onmessage=t=>this.onConnMessage(t),this.conn.onclose=t=>this.onConnClose(t))}log(e,t,r){this.logger(e,t,r)}hasLogger(){return this.logger!==null}onOpen(e){let t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}onClose(e){let t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}onError(e){let t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}onMessage(e){let t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}ping(e){if(!this.isConnected())return!1;let t=this.makeRef(),r=Date.now();this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:t});let s=this.onMessage(i=>{i.ref===t&&(this.off([s]),e(Date.now()-r))});return!0}clearHeartbeats(){clearTimeout(this.heartbeatTimer),clearTimeout(this.heartbeatTimeoutTimer)}onConnOpen(){this.hasLogger()&&this.log("transport",`connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,e])=>e())}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.triggerChanError(),this.closeWasClean=!1,this.teardown(()=>this.reconnectTimer.scheduleTimeout(),Ka,"heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,this.clearHeartbeats(),this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(e,t,r){if(!this.conn)return e&&e();this.waitForBufferDone(()=>{this.conn&&(t?this.conn.close(t,r||""):this.conn.close()),this.waitForSocketClosed(()=>{this.conn&&(this.conn.onopen=function(){},this.conn.onerror=function(){},this.conn.onmessage=function(){},this.conn.onclose=function(){},this.conn=null),e&&e()})})}waitForBufferDone(e,t=1){if(t===5||!this.conn||!this.conn.bufferedAmount){e();return}setTimeout(()=>{this.waitForBufferDone(e,t+1)},150*t)}waitForSocketClosed(e,t=1){if(t===5||!this.conn||this.conn.readyState===b.closed){e();return}setTimeout(()=>{this.waitForSocketClosed(e,t+1)},150*t)}onConnClose(e){let t=e&&e.code;this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),this.clearHeartbeats(),!this.closeWasClean&&t!==1e3&&this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,r])=>r(e))}onConnError(e){this.hasLogger()&&this.log("transport",e);let t=this.transport,r=this.establishedConnections;this.stateChangeCallbacks.error.forEach(([,s])=>{s(e,t,r)}),(t===this.transport||r>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach(e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(k.error)})}connectionState(){switch(this.conn&&this.conn.readyState){case b.connecting:return"connecting";case b.open:return"open";case b.closing:return"closing";default:return"closed"}}isConnected(){return this.connectionState()==="open"}remove(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}off(e){for(let t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter(([r])=>e.indexOf(r)===-1)}channel(e,t={}){let r=new za(e,t,this);return this.channels.push(r),r}push(e){if(this.hasLogger()){let{topic:t,event:r,payload:s,ref:i,join_ref:n}=e;this.log("push",`${t} ${r} (${n}, ${i})`,s)}this.isConnected()?this.encode(e,t=>this.conn.send(t)):this.sendBuffer.push(()=>this.encode(e,t=>this.conn.send(t)))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimeoutTimer=setTimeout(()=>this.heartbeatTimeout(),this.heartbeatIntervalMs))}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:n,join_ref:o}=t;n&&n===this.pendingHeartbeatRef&&(this.clearHeartbeats(),this.pendingHeartbeatRef=null,this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${i.status||""} ${r} ${s} ${n&&"("+n+")"||""}`,i);for(let a=0;a<this.channels.length;a++){const c=this.channels[a];c.isMember(r,s,i,o)&&c.trigger(s,i,n,o)}for(let a=0;a<this.stateChangeCallbacks.message.length;a++){let[,c]=this.stateChangeCallbacks.message[a];c(t)}})}leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r.isJoined()||r.isJoining()));t&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${e}"`),t.leave())}},se,Ja=new Uint8Array(16);function Xa(){if(!se&&(se=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!se))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return se(Ja)}const Qa=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Za(e){return typeof e=="string"&&Qa.test(e)}var v=[];for(var De=0;De<256;++De)v.push((De+256).toString(16).substr(1));function qa(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase();if(!Za(r))throw TypeError("Stringified UUID is invalid");return r}function Pe(e,t,r){e=e||{};var s=e.random||(e.rng||Xa)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,qa(s)}class f extends Error{constructor(t,r,s){super(t),Object.setPrototypeOf(this,f.prototype),this.name="UserflowError",this.code=r,this.humanMessage=s}}class jr{constructor(t){this.type=t,this.testState={}}formatKey(t){return`userflow:${t}`}isSupported(){if(typeof window>"u")return!1;try{return window[this.type]!=null}catch{return!1}}getItem(t){return t=this.formatKey(t),this.isSupported()?window[this.type].getItem(t):null}setItem(t,r){t=this.formatKey(t);{if(!this.isSupported())return;window[this.type].setItem(t,r)}}removeItem(t){return t=this.formatKey(t),this.isSupported()?window[this.type].removeItem(t):void 0}clear(){return this.isSupported()?window[this.type].clear():void 0}}const ie=new jr("localStorage"),I=new jr("sessionStorage");function ol(e){window.location.href=e}function Br(){return window.location.href}function ze(e){window.postMessage(e,window.origin)}function xr(e){const t=s=>{if(s.source!==window||s.origin!==window.origin)return;const i=s.data;!i||typeof i!="object"||typeof i.kind!="string"||!i.kind.startsWith("userflow:")||e(i)===!0&&r()};window.addEventListener("message",t);const r=()=>window.removeEventListener("message",t);return r}function ec(e){return new Promise(t=>{xr(r=>{const s=e(r);return s?(t(s),!0):!1})})}const nt=new Set;let Wt=!1;function tc(e){return rc(),nt.add(e),()=>{Hr(e)}}function Hr(e){nt.delete(e)}function ne(){nt.forEach(e=>e())}function rc(){if(Wt)return;Wt=!0;const{history:e}=window,t=r=>{const s=e[r];e[r]=(...i)=>{const n=s.apply(e,i);return ne(),n}};window.__userflowStatePatched?(window.addEventListener("userflow:pushstate",()=>{ne()}),window.addEventListener("userflow:replacestate",()=>{ne()})):(t("pushState"),t("replaceState")),window.addEventListener("popstate",()=>{ne()})}class sc{destroy(){this.unregisterOnMessage&&this.unregisterOnMessage()}postBuilderMessage(t){ze({kind:"userflow:crxSendProxyMessage",direction:"targetToBuilder",message:t})}onBuilderMessage(t){return this.unregisterOnMessage=xr(t),!1}async captureScreenshot(t,r,s,i){return ze({kind:"userflow:crxScreenshot",x:t,y:r,width:s,height:i,devicePixelRatio:window.devicePixelRatio}),(await ec(o=>o.kind==="userflow:crxScreenshotResult"?o:null)).imageDataUrl}}var le=(e=>(e.ACTION="ACTION",e.LAUNCHER_DEACTIVATED="LAUNCHER_DEACTIVATED",e.REPLACED="REPLACED",e.SNOOZED="SNOOZED",e.TOOLTIP_TARGET_MISSING="TOOLTIP_TARGET_MISSING",e.USERFLOWJS="USERFLOWJS",e.USER_CLOSED="USER_CLOSED",e))(le||{}),ic=(e=>(e.SECOND="SECOND",e.MINUTE="MINUTE",e.HOUR="HOUR",e.DAY="DAY",e))(ic||{}),ve=(e=>(e.ACTION="ACTION",e.DRAFT="DRAFT",e.LINK="LINK",e.LAUNCHER_SEEN="LAUNCHER_SEEN",e.RESOURCE_CENTER="RESOURCE_CENTER",e.USERFLOWJS="USERFLOWJS",e))(ve||{}),nc=(e=>(e.LIKE="LIKE",e.DISLIKE="DISLIKE",e))(nc||{}),y=(e=>(e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.NUMBER="NUMBER",e.DATETIME="DATETIME",e.LIST="LIST",e.RANDOM_AB="RANDOM_AB",e.RANDOM_NUMBER="RANDOM_NUMBER",e.CHECKLIST_TASK="CHECKLIST_TASK",e.FLOW="FLOW",e.FLOW_SESSION="FLOW_SESSION",e.FLOW_STEP="FLOW_STEP",e.FLOW_VERSION="FLOW_VERSION",e))(y||{}),he=(e=>(e.FLOW="FLOW",e.BANNER="BANNER",e.EMBED="EMBED",e.CHECKLIST="CHECKLIST",e.LAUNCHER="LAUNCHER",e.RESOURCE_CENTER="RESOURCE_CENTER",e))(he||{}),oc=(e=>(e.ALWAYS_TRUE="ALWAYS_TRUE",e.ATTRIBUTE="ATTRIBUTE",e.CHECKLIST_TASK_CLICKED="CHECKLIST_TASK_CLICKED",e.CLAUSE="CLAUSE",e.ELEMENT="ELEMENT",e.EVENT="EVENT",e.FILLED_IN_INPUT="FILLED_IN_INPUT",e.FLOW="FLOW",e.INPUT_VALUE="INPUT_VALUE",e.PAGE="PAGE",e.SEGMENT="SEGMENT",e.TIME="TIME",e))(oc||{}),ac=(e=>(e.AUTO="AUTO",e.MANUAL="MANUAL",e))(ac||{}),cc=(e=>(e.INPUT="INPUT",e))(cc||{}),lc=(e=>(e.ABSOLUTE_EQ="ABSOLUTE_EQ",e.ABSOLUTE_GT="ABSOLUTE_GT",e.ABSOLUTE_LT="ABSOLUTE_LT",e.AND="AND",e.BETWEEN="BETWEEN",e.CONTAINS="CONTAINS",e.EMPTY="EMPTY",e.ENDS_WITH="ENDS_WITH",e.EQ="EQ",e.EXCLUDES_ALL="EXCLUDES_ALL",e.EXCLUDES_ANY="EXCLUDES_ANY",e.FALSE="FALSE",e.GT="GT",e.GTE="GTE",e.INCLUDES_ALL="INCLUDES_ALL",e.INCLUDES_ANY="INCLUDES_ANY",e.LT="LT",e.LTE="LTE",e.NE="NE",e.NOT_CONTAINS="NOT_CONTAINS",e.NOT_EMPTY="NOT_EMPTY",e.NOT_REGEX="NOT_REGEX",e.OR="OR",e.REGEX="REGEX",e.RELATIVE_EQ="RELATIVE_EQ",e.RELATIVE_GT="RELATIVE_GT",e.RELATIVE_LT="RELATIVE_LT",e.STARTS_WITH="STARTS_WITH",e.TRUE="TRUE",e.URL="URL",e))(lc||{}),hc=(e=>(e.CLICK="CLICK",e.DISABLED="DISABLED",e.MOUSEDOWN="MOUSEDOWN",e.NOT_CLICK="NOT_CLICK",e.NOT_DISABLED="NOT_DISABLED",e.NOT_PRESENT="NOT_PRESENT",e.PRESENT="PRESENT",e))(hc||{}),uc=(e=>(e.END_USER="END_USER",e.GROUP="GROUP",e))(uc||{}),dc=(e=>(e.BETWEEN="BETWEEN",e.EQ="EQ",e.GTE="GTE",e.LTE="LTE",e))(dc||{}),fc=(e=>(e.ANY="ANY",e.RELATIVE_BETWEEN="RELATIVE_BETWEEN",e.RELATIVE_GT="RELATIVE_GT",e.RELATIVE_LT="RELATIVE_LT",e))(fc||{}),Ec=(e=>(e.CURRENT_USER="CURRENT_USER",e.CURRENT_USER_CURRENT_GROUP="CURRENT_USER_CURRENT_GROUP",e.CURRENT_GROUP="CURRENT_GROUP",e))(Ec||{}),vc=(e=>(e.ASSET="ASSET",e.CARTOON="CARTOON",e.NONE="NONE",e.URL="URL",e))(vc||{}),gc=(e=>(e.INSIDE="INSIDE",e.OUTSIDE="OUTSIDE",e))(gc||{}),Tc=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_CENTER="TOP_CENTER",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e.BOTTOM_CENTER="BOTTOM_CENTER",e.BOTTOM_LEFT="BOTTOM_LEFT",e.CENTER="CENTER",e))(Tc||{}),Sc=(e=>(e.GOOGLE="GOOGLE",e.STANDARD="STANDARD",e))(Sc||{}),pc=(e=>(e.DISMISS_FIRST_MENU_AFTER="DISMISS_FIRST_MENU_AFTER",e.DISMISS="DISMISS",e))(pc||{}),mc=(e=>(e.DISMISS="DISMISS",e.NONE="NONE",e))(mc||{}),Ic=(e=>(e.DEFAULT="DEFAULT",e.NARROW="NARROW",e.CHAINED_SQUARED="CHAINED_SQUARED",e.CHAINED_ROUNDED="CHAINED_ROUNDED",e.DOTTED="DOTTED",e.NUMBERED="NUMBERED",e))(Ic||{}),wc=(e=>(e.TOP="TOP",e.BOTTOM="BOTTOM",e))(wc||{}),Cc=(e=>(e.DEFAULT="DEFAULT",e.PLAINTEXT="PLAINTEXT",e.CUSTOM="CUSTOM",e))(Cc||{}),yc=(e=>(e.CHECKLIST_OVERRIDE="CHECKLIST_OVERRIDE",e.RESOURCE_CENTER_ONLY="RESOURCE_CENTER_ONLY",e.NONE="NONE",e))(yc||{}),bc=(e=>(e.BUBBLE="BUBBLE",e.END="END",e.ERROR="ERROR",e.FLAG="FLAG",e))(bc||{}),Rc=(e=>(e.MANUAL="MANUAL",e.NONE="NONE",e.SYNTHETIC="SYNTHETIC",e))(Rc||{}),Oc=(e=>(e.BUBBLE="BUBBLE",e.HIDDEN="HIDDEN",e.MODAL="MODAL",e.TOOLTIP="TOOLTIP",e))(Oc||{}),kc=(e=>(e.ABOVE="ABOVE",e.BELOW="BELOW",e.LEFT="LEFT",e.RIGHT="RIGHT",e))(kc||{}),Nc=(e=>(e.CLOSE_FLOW="CLOSE_FLOW",e.EVAL_JS="EVAL_JS",e.GO_TO_STEP="GO_TO_STEP",e.NAVIGATE="NAVIGATE",e.SET_ATTRIBUTE="SET_ATTRIBUTE",e.SNOOZE="SNOOZE",e.START_FLOW="START_FLOW",e))(Nc||{}),Uc=(e=>(e.NEW_TAB="NEW_TAB",e.SAME_TAB="SAME_TAB",e))(Uc||{}),Lc=(e=>(e.SET="SET",e.SET_DATETIME="SET_DATETIME",e.SET_DATETIME_ONCE="SET_DATETIME_ONCE",e.SET_ONCE="SET_ONCE",e.ADD="ADD",e.SUBTRACT="SUBTRACT",e.APPEND="APPEND",e.PREPEND="PREPEND",e.REMOVE="REMOVE",e.UNSET="UNSET",e))(Lc||{}),_c=(e=>(e.MULTILINE_TEXT="MULTILINE_TEXT",e.MULTIPLE_CHOICE="MULTIPLE_CHOICE",e.NPS="NPS",e.SCALE="SCALE",e.STARS="STARS",e.TEXT="TEXT",e))(_c||{}),Ye=(e=>(e.ACTION="ACTION",e.ANNOUNCEMENTS="ANNOUNCEMENTS",e.ASSISTANT="ASSISTANT",e.CHECKLIST="CHECKLIST",e.CONTACT="CONTACT",e.DIVIDER="DIVIDER",e.FLOWS="FLOWS",e.KNOWLEDGE_BASE="KNOWLEDGE_BASE",e.MESSAGE="MESSAGE",e.SUBPAGE="SUBPAGE",e))(Ye||{}),Ac=(e=>(e.CRISP="CRISP",e.CUSTOM="CUSTOM",e.FRESHCHAT="FRESHCHAT",e.HELPSCOUT="HELPSCOUT",e.HUBSPOT="HUBSPOT",e.INTERCOM="INTERCOM",e.ZENDESK="ZENDESK",e.ZENDESK_MESSENGER="ZENDESK_MESSENGER",e))(Ac||{}),$c=(e=>(e.BUTTON="BUTTON",e.INPUT="INPUT",e))($c||{}),Dc=(e=>(e.EMAIL="EMAIL",e.PHONE="PHONE",e.CHAT="CHAT",e))(Dc||{}),Pc=(e=>(e.SILENT="SILENT",e.BADGE="BADGE",e.POPOUT="POPOUT",e.MODAL="MODAL",e.TOAST="TOAST",e))(Pc||{}),Mc=(e=>(e.LAUNCHER_CLICK="LAUNCHER_CLICK",e.LAUNCHER_HOVER="LAUNCHER_HOVER",e.TARGET_CLICK="TARGET_CLICK",e.TARGET_HOVER="TARGET_HOVER",e.LAUNCHER_TARGET_CLICK="LAUNCHER_TARGET_CLICK",e.LAUNCHER_TARGET_HOVER="LAUNCHER_TARGET_HOVER",e))(Mc||{}),Gr=(e=>(e.ACTIVATE="ACTIVATE",e.DEACTIVATE="DEACTIVATE",e.NEVER="NEVER",e))(Gr||{}),jc=(e=>(e.AUTO="AUTO",e.TOP="TOP",e.RIGHT="RIGHT",e.BOTTOM="BOTTOM",e.LEFT="LEFT",e))(jc||{}),Bc=(e=>(e.START="START",e.CENTER="CENTER",e.END="END",e))(Bc||{}),xc=(e=>(e.PERCENT="PERCENT",e.PX="PX",e))(xc||{}),Hc=(e=>(e.BEACON="BEACON",e.BUTTON="BUTTON",e.HIDDEN="HIDDEN",e.ICON="ICON",e))(Hc||{}),Gc=(e=>(e.LAUNCHER="LAUNCHER",e.TARGET="TARGET",e))(Gc||{}),Fc=(e=>(e.BODY_FIRST="BODY_FIRST",e.BODY_LAST="BODY_LAST",e.ELEMENT_FIRST="ELEMENT_FIRST",e.ELEMENT_LAST="ELEMENT_LAST",e.ELEMENT_BEFORE="ELEMENT_BEFORE",e.ELEMENT_AFTER="ELEMENT_AFTER",e))(Fc||{}),Wc=(e=>(e.BODY_FIRST="BODY_FIRST",e.BODY_LAST="BODY_LAST",e.ELEMENT_FIRST="ELEMENT_FIRST",e.ELEMENT_LAST="ELEMENT_LAST",e.ELEMENT_BEFORE="ELEMENT_BEFORE",e.ELEMENT_AFTER="ELEMENT_AFTER",e))(Wc||{}),Kc=(e=>(e.ALWAYS="ALWAYS",e.MULTIPLE="MULTIPLE",e.NEVER="NEVER",e.ONCE="ONCE",e.ONCE_PER_GROUP="ONCE_PER_GROUP",e))(Kc||{}),Vc=(e=>(e.NONE="NONE",e.PENDING_SCHEDULE="PENDING_SCHEDULE",e.SCHEDULED="SCHEDULED",e.FIRED="FIRED",e))(Vc||{}),zc=(e=>(e.NONE="NONE",e.LIKE="LIKE",e.SCALE="SCALE",e))(zc||{}),Yc=(e=>(e.HIDE="HIDE",e.BLOCK="BLOCK",e.OTHERS="OTHERS",e))(Yc||{});function Jc(){return{customInputs:[],customNavigate:null,urlFilter:null,linkUrlDecorator:null,customScrollIntoView:null,scrollPadding:null,inferenceAttributeNames:["data-for","data-id","data-testid","data-test-id","for","id","name","placeholder","role"],inferenceAttributeFilters:{id:[e=>!e.match(/\d$/)],"data-id":[e=>!e.match(/\d$/)]},inferenceClassNameFilters:[e=>!e.startsWith("css-")],baseZIndex:1234500,evalJsDisabled:!1}}const g=Jc();function Kt(e){return Array.isArray(e)||(e=e?[e]:[]),e=e.map(t=>typeof t=="string"?new RegExp(t):t),e}function al(e,t){return e.every(r=>typeof r=="function"?r(t):r instanceof RegExp?r.test(t):!0)}function Xc(){let e=Br();if(g.urlFilter){if(e=g.urlFilter(e),typeof e!="string")throw new f("Userflow.js: URL filter returned non-string value. Please check your userflow.setUrlFilter() implementation.");try{new URL(e)}catch(t){throw new f(`Userflow.js: URL filter returned an invalid URL. Please check your userflow.setUrlFilter() implementation.
Returned URL: `+e+`
Error message: `+t.message)}}return e}let Fr="";try{Fr=localStorage.getItem("debug")||""}catch{}const Wr=Fr.split(",").some(e=>e==="*"||e.startsWith("userflow:*")),h=ot("log");h.group=ot("group");h.groupCollapsed=ot("groupCollapsed");h.groupEnd=function(){Wr&&console.groupEnd()};let Me;function ot(e){return function(t,...r){if(Wr){const s=performance.now(),i=Me?Math.round(s-Me):0;Me=s,console[e](`%cuserflow %c${t} %c+${i}ms`,"color:#1a57e6;","","color:#1a57e6;",...r)}}}const Qc=()=>U(()=>import("./ResourceCenterApp.v1.DUrtOQxF.js").then(e=>e.R),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]));function Zc(e){const r=e.version.checklist.tasks.length;return Math.max(0,r-e.taskCompletions.length)}class Vt{constructor(t){this.observers=new Set,this._value=t}get value(){return this._value}update(t){if(t!==this._value){this._value=t;for(const r of this.observers)r()}}observe(t){return this.observers.add(t),()=>this.observers.delete(t)}}const zt=["page:before-change","page:change","turbo:before-cache","turbo:load","turbo:visit","turbolinks:before-cache","turbolinks:load","turbolinks:visit"],qc=()=>U(()=>import("./BannerApp.v1.CdCRjG8y.js"),__vite__mapDeps([15,1,2,8,7,5,6,4,9,3,14,10])),je="1011848",el=import.meta.url,Yt=50,tl=5*60*1e3,Jt="userflowClientState";class rl{constructor(){this.clientToken=null,this.externalId=null,this.signature=null,this.groupId=null,this.groupSignature=null,this._socketStatus="disconnected",this.socket=null,this.channel=null,this.logrocketAppId=null,this.debounceInactiveDisconnectTimeout=void 0,this.inBatch=!1,this.endBatchTimeout=void 0,this.pushRateLimitMinute=0,this.pushRateLimitMinuteExpires=0,this.clientClock=1,this.serverClock=1,this.flowSession=null,this.flowSessionClock=0,this.checklistSession=null,this.checklistExpanded=!1,this.checklistExpandPending=!1,this.checklistSessionClock=0,this.bannerSession=null,this.resourceCenterSession=null,this.resourceCenterOpen=!1,this.resourceCenterLauncherHidden=!1,this.launcherSessions=[],this.activeLauncherFlowId=null,this.notifications=[],this.embedSessions=[],this.notificationIdCounter=0,this.sessionStorageState=null,this.clientContext=null,this.flushUrlChangeTimeout=void 0,this.onFirstIdentifyRun=!1,this.onFirstIdentifyTimeout=void 0,this.firstIdentifyCallback=null,this.ui=null,this.debuggerUI=null,this.unackedTasks=new Set,this.clientConditions=new Map,this.trackers=new Map,this.conditionWaitTimers=new Map,this.listeners=new Map,this.targetEnv=null,this.idempotencyKeysSeen=new Set,this.testUserIdentified=!1,this.cspIssueReported=!1,this.uiDisabled=!1,this.audio=null,this.audioReady=!1,this.pageTrackingDisabled=!1,this.refCounter=1,this.implicitTrackingQueue=[],this.onBuilderMessage=t=>(this.handleBuilderMessage(t),!1),this.handleBuilderMessage=async t=>{h(`builder ${t.kind} message received`,t);const r="idempotencyKey"in t&&typeof t.idempotencyKey=="string"?t.idempotencyKey:null;if(r&&this.idempotencyKeysSeen.has(r))return;const s=()=>{r&&this.idempotencyKeysSeen.add(r)};switch(t.kind){case"userflow:selectElement":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:selectElementAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0,activeApp:"elementSelection",elementSelection:{mode:"select",elementType:t.elementType}}));return}case"userflow:selectElementCancel":{this.setSessionStorageState(i=>({...i,activeApp:null,elementSelection:null}));return}case"userflow:startFlowWithToken":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:startFlowWithTokenAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0,activeApp:null,testStartConditionToken:void 0})),I.setItem("previewFlowId",t.flowId),t.testUser?this.identifyTestUser(t.testUser):this.resetTestUser(),t.testStartCondition?this.setSessionStorageState(i=>({...i,activeApp:"startConditionTesting",testStartConditionToken:t.token})):this.onceIdentified(()=>{if(this.startFlowWithToken(t.token),t.isResourceCenter){const i=()=>{const n=this.resourceCenterSession;n&&n.draftMode&&n.flow.id===t.flowId&&(this.openResourceCenter(),this.off("resourceCenterChanged",i))};this.on("resourceCenterChanged",i),i()}});return}case"userflow:testTracker":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:testTrackerAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0})),t.testUser?this.identifyTestUser(t.testUser):this.resetTestUser(),this.setSessionStorageState(i=>({...i,activeApp:"trackerTesting",trackerTesting:{trackerName:t.trackerName,token:t.token,events:0}}));return}case"userflow:testTrackerCancel":{this.setSessionStorageState(i=>({...i,activeApp:null,trackerTesting:null}));return}}},this.onUrlChange=()=>{this.externalId&&(window.clearTimeout(this.flushUrlChangeTimeout),this.flushUrlChangeTimeout=window.setTimeout(()=>this.flushUrlChange(),Yt))},this.onUserActivity=()=>this.ensureConnected(),this.remountIfNecessary=()=>{!this.ui?.container||document.contains(this.ui.container)||(h("remounting UI because container was missing"),this.remount())},h("constructor, build="+je),tc(this.onUrlChange),this.setTargetEnv(new sc),this.checkTestUserAtBoot(),this.toggleUI(),this.checkDebuggerSession();for(const t of zt)document.addEventListener(t,this.remountIfNecessary)}get socketStatus(){return this._socketStatus}destroy(){h("destroy"),this.reset(),Hr(this.onUrlChange),this.destroyTargetEnv();for(const t of zt)document.removeEventListener(t,this.remountIfNecessary)}setTargetEnv(t){this.destroyTargetEnv(),this.targetEnv=t,t.onBuilderMessage(this.onBuilderMessage)}destroyTargetEnv(){this.targetEnv&&(this.targetEnv.destroy(),this.targetEnv=null)}getTargetEnv(){if(!this.targetEnv)throw new f("Userflow.js: Cannot call getTargetEnv when protocol is not set");return this.targetEnv}setSessionStorageState(t){const r=t(this.getSessionStorageState());I.setItem(Jt,JSON.stringify(r)),this.sessionStorageState=r,this.toggleUI()}getSessionStorageState(){let t=this.sessionStorageState;if(!t){const r=I.getItem(Jt);if(r)try{t=JSON.parse(r)}catch(s){console.error("Userflow.js: Parse ElementSelectionState error:",s)}t||(t={testUser:null,activeApp:null,elementSelection:null,trackerTesting:null}),this.sessionStorageState=t}return t}checkTestUserAtBoot(){const t=this.getSessionStorageState().testUser;t&&(h("checkTestUserAtBoot identifying test user"),this.identifyTestUser(t))}async identifyTestUser(t){this.setSessionStorageState(i=>({...i,testUser:t})),this.reset(),this.init(t.clientToken),this.testUserIdentified=!0,this.externalId=t.id;const r=[this.identify(t.id,{name:t.name,email:t.email,signed_up_at:{set_once:new Date().toISOString(),data_type:"datetime"}},{signature:t.signature})],{group:s}=t;s&&(this.groupId=s.id,r.push(this.group(s.id,{name:s.name},{signature:s.signature}))),await Promise.all(r)}resetTestUser(){this.setSessionStorageState(t=>({...t,testUser:null}))}init(t){if(h("init",t),!t)throw new f("userflow.init() was called but missing Userflow.js Token");if(this.clientToken!==t){if(this.testUserIdentified){h("init() ignoring new token since a test user has been identified");return}this.clientToken&&(h("init() resetting due to new client token"),this.reset()),this.clientToken=t,this.emit("private:initialised")}}ensureInit(){if(!this.clientToken)throw new f("You must call userflow.init() first")}ensureIdentified(){if(this.ensureInit(),!this.externalId)throw new f("You must call userflow.identify() first");return this.externalId}ensureGroup(){if(this.ensureIdentified(),!this.groupId)throw new f("You must call userflow.group() first");return this.groupId}ensureConnected(){if(!this.clientToken||!this.externalId||(this.debounceInactiveDisconnect(),this.socket))return;this._socketStatus="connecting",h("connecting to socket");let t=g.serverEndpoint||"e.userflow.com";new URL(el).hostname==="js.getuserflow.com"&&t==="e.userflow.com"&&(t="e.getuserflow.com");const r="wss://"+t+"/end-users/"+this.clientToken+"/socket";this.socket=new Ya(r,{reconnectAfterMs:s=>[100,500,1e3,5e3][s-1]||1e4,timeout:20*1e3}),this.socket.connect(),this.socket.onOpen(()=>{h("socket opened")}),this.socket.onClose(()=>{this.emit("private:disconnect")}),this.socket.onError(s=>{console.log("Userflow.js socket error",s),this.reportCspIssue()}),this.channel=this.socket.channel(`end_users:${this.externalId}`,()=>this.makeChannelJoinPayload()),this.channel.join().receive("ok",s=>{this.logrocketAppId=s.logrocketAppId,this.featureFlags=new Set(s.featureFlags),h("channel joined"),this._socketStatus!=="connected"&&(this._socketStatus="connected"),this.flushImplicitTrackingQueue(),this.featureFlagEnabled("cff_implicit_events")===!0&&this.startImplicitTracking()}).receive("error",s=>{["company_closed","invalid_client_token","invalid_user_external_id","incorrect_user_signature","rate_limit_exceeded","user_signature_required"].includes(s.code)?(console.error(`Userflow.js resetting due to: [${s.code}] ${s.message}`),this.reset(),this.clientToken=null):s.code==="invalid_protocol_version"?(console.error(`Userflow.js destroying due to: [${s.code}] ${s.message}`),this.destroy()):console.log("Userflow.js channel join error",s)}),this.channel.on("server_message",s=>this.handleServerMessage(s)),this.channel.on("server_error",s=>{console.log(`Userflow.js server error (${s.code}): ${s.message}`+(s.details&&s.details.length>0?`
Details:
`+s.details.map(i=>(i.path?`${i.path}: `:"")+i.message):""))}),this.channel.onClose(()=>{this.flushImplicitTrackingQueue(),this.implicitTracking?.stop()})}async startImplicitTracking(){await U(()=>import("./implicit-tracking.v1.C-WeXLGI.js"),__vite__mapDeps([16,6])).then(t=>this.implicitTracking=new t.ImplicitTracking(this)).catch(t=>h(`Implicit tracking failed to load ${t}`)),this.implicitTracking.start()}flushImplicitTrackingQueue(){this.featureFlagEnabled("cff_implicit_events")===!0&&this.implicitTrackingQueue.forEach(t=>{this.trackRawEvent({name:"page_viewed",attributes:t})}),this.implicitTrackingQueue=[]}makeChannelJoinPayload(){const t=this.buildClientContext();this.clientContext=t;const r={protocolVersion:2,userflowClientBuild:je,signature:this.signature,groupExternalId:this.groupId,groupSignature:this.groupSignature,flowSessionId:this.flowSession?.id||null,checklistSessionId:this.checklistSession?.id||null,bannerSessionId:this.bannerSession?.id||null,resourceCenterSessionId:this.resourceCenterSession?.id||null,launchers:this.launcherSessions.map(s=>({flowId:s.flow.id})),trackers:Array.from(this.trackers.values()).map(s=>({flowId:s.tracker.flowId})),hasDraftSession:this.hasDraftSession(),clientConditions:Array.from(this.clientConditions.values()).map(s=>({conditionId:s.condition.id,isTrue:s.isTrue})),previewFlowId:I.getItem("previewFlowId"),clientContext:t};return h("channel join payload",r),r}disconnect(){window.clearTimeout(this.debounceInactiveDisconnectTimeout),this.socket&&this.socket.disconnect(),this._socketStatus="disconnected",this.socket=null,this.channel=null}debounceInactiveDisconnect(){window.clearTimeout(this.debounceInactiveDisconnectTimeout),this.debounceInactiveDisconnectTimeout=window.setTimeout(()=>{if(this.hasDraftSession()||this.assistantMessageInProgress){this.debounceInactiveDisconnect();return}h("disconnecting from socket due to inactivity"),this.disconnect()},tl)}hasDraftSession(){return!!this.flowSession?.draftMode||!!this.checklistSession?.draftMode||!!this.bannerSession?.draftMode||!!this.resourceCenterSession?.draftMode||this.launcherSessions.some(t=>t.draftMode)}async send(t,{batch:r,endBatch:s,handlesRejection:i}={}){return(!this.inBatch||!["ToggleClientCondition","UpdateClientContext"].includes(t.kind))&&this.checkPushRateLimit(),this.ensureConnected(),r&&!this.inBatch&&(this.inBatch=!0,this.sendRaw({kind:"BeginBatch"})),this.inBatch&&(window.clearTimeout(this.endBatchTimeout),s?this.endBatch():this.endBatchTimeout=window.setTimeout(()=>{this.endBatch()},Yt)),this.sendRaw(t,{handlesRejection:i})}async sendRaw(t,{handlesRejection:r}={}){return new Promise((s,i)=>{if(!this.channel){const c=`Userflow.js: send() should not be called if channel is not set. Message kind=${t.kind}`;if(r)throw Error(c);console.log(c,`
Client message:`,t);return}h(`push ${t.kind} message`,t);const n=this.clientClock,o=()=>{this.serverClock=n,this.channel?.off("phx_error",a)},a=this.channel.on("phx_error",c=>{o();const l=`Userflow.js send ${t.kind} got phx_error`;this._socketStatus==="connected"&&console.log(l,`
Client message:`,t,`
Error:`,c),r&&i(new f(l))});this.channel.push("client_message",t).receive("ok",c=>{o(),s(c)}).receive("error",c=>{o();const l=`Userflow.js error reply (${c.code}): ${c.message}`;console.log(l,`
Client message:`,t,`
Error:`,c),r&&i(new f(l,c.code,c.message))})})}endBatch(){this.inBatch=!1,this.sendRaw({kind:"EndBatch"})}checkPushRateLimit(){const t=this.featureFlagEnabled("cff_implicit_events")===!0?200:100,r=Date.now();if(this.pushRateLimitMinuteExpires<r&&(this.pushRateLimitMinute=0,this.pushRateLimitMinuteExpires=r+60*1e3),this.pushRateLimitMinute>=t)throw new f(`This Userflow.js client has reached a maximum of ${t} operations in the last 1 minute. This is usually due to one of the following:

        - Excessive calls to Userflow.js. Check if any of userflow.track(), userflow.identify(), userflow.updateUser() or similar are called repeatedly.
        - The URL changing too frequently. Look into https://userflow.com/docs/userflow-js#seturlfilter and filter out the changing part of the URL.
        - The user legitimately being very active, in which case you can just ignore this error.

        If in doubt, reach out to us at support@userflow.com.`);this.pushRateLimitMinute++}handleServerMessage(t){h(`received ${t.kind} message`,t);const{serverClock:r,flowSession:s,flowSessionClock:i,checklistSession:n,checklistSessionClock:o,bannerSession:a,resourceCenterSession:c}=this;switch(t.kind){case"CheckSessionsAck":this.emit("private:checkSessionsAck");return;case"ServerDebug":return;case"AddLauncher":{const{session:l}=t,u=this.launcherSessions.findIndex(d=>d.flow.id===l.flow.id);u===-1?this.launcherSessions=[...this.launcherSessions,l]:this.launcherSessions=[...this.launcherSessions.slice(0,u),l,...this.launcherSessions.slice(u+1)],this.toggleUI();return}case"AddTracker":{this.addTracker(t.tracker);return}case"AssistantMessageEventWrapper":{this.emit("private:assistantMessageEvent",t);return}case"CancelConditionWaitTimer":window.clearTimeout(this.conditionWaitTimers.get(t.conditionId)),this.conditionWaitTimers.delete(t.conditionId);return;case"ChecklistTaskCompleted":this.unackedTasks.add(t.taskCvid);return;case"ForceGoToStep":if(i>r){h(`ignoring ${t.kind} message due to stale clock flowSessionClock=${i} > serverClock=${r}`);return}s?.id===t.sessionId&&this.emit("gotostep",{session:s,step:{id:t.stepId}});return;case"RemoveLauncher":this.removeLauncher(t.flowId)&&this.toggleUI();return;case"RemoveTracker":{this.removeTracker(t.flowId);return}case"SetBannerSession":this.setBannerSession(t.session),this.toggleUI();return;case"SetChecklistSession":o<=r||n?.id===t.session.id?(this.setChecklistSession(t.session,r),this.toggleUI()):h(`ignoring ${t.kind} message due to stale clock checklistSessionClock=${o} > serverClock=${r}`);return;case"SetFlowSession":i<=r||s?.id===t.session.id?(this.setFlowSession(t.session,r),this.emit("private:setFlowSession",t.session.version.id),this.toggleUI()):h(`ignoring ${t.kind} message due to stale clock flowSessionClock=${i} > serverClock=${r}`);return;case"SetResourceCenterSession":this.setResourceCenterSession(t.session),this.toggleUI();return;case"StartConditionWaitTimer":{if(!this.conditionWaitTimers.has(t.conditionId)){const l=window.setTimeout(()=>{this.conditionWaitTimers.delete(t.conditionId),this.send({kind:"FireConditionWaitTimer",conditionId:t.conditionId},{batch:!0})},parseFloat(t.waitTime)*1e3);this.conditionWaitTimers.set(t.conditionId,l)}return}case"TestStartConditionSuccess":this.emit("private:testStartConditionSuccess");return;case"TrackClientCondition":this.trackClientCondition(t.condition);return;case"UnsetBannerSession":a?.id===t.sessionId&&(this.setBannerSession(null),this.toggleUI());return;case"UnsetChecklistSession":if(o>r){h(`ignoring ${t.kind} message due to stale clock checklistSessionClock=${o} > serverClock=${r}`);return}n?.id===t.sessionId&&(this.setChecklistSession(null,r),this.toggleUI());return;case"UnsetFlowSession":if(i>r){h(`ignoring ${t.kind} message due to stale clock flowSessionClock=${i} > serverClock=${r}`);return}s?.id===t.sessionId&&(this.setFlowSession(null,r),this.toggleUI());return;case"UnsetResourceCenterSession":c?.id===t.sessionId&&(this.setResourceCenterSession(null),this.toggleUI());return;case"UntrackClientCondition":this.untrackClientCondition(t.conditionId);return;case"AddEmbed":{const l=this.embedSessions?.findIndex(u=>u.flow.id===t.session.flow.id);l!==void 0&&l>=0?this.embedSessions=[...this.embedSessions?.slice(0,l)||[],t.session,...this.embedSessions?.slice(l+1)||[]]:this.embedSessions=[...this.embedSessions||[],t.session],this.emit("uistatechange");break}case"RemoveEmbed":{this.embedSessions=(this.embedSessions||[]).filter(l=>l.flow.id!==t.flowId),this.emit("uistatechange");break}default:console.warn("Userflow.js: Received unknown message",t);return}}async identify(t,r={},{signature:s}={}){if(h("identify",t),this.ensureInit(),this.testUserIdentified&&t!==this.externalId){h("identify() ignored since a test user has been identified");return}if(typeof t=="number")t=String(t);else if(!t||typeof t!="string")throw new f(`userflow.identify: First argument must be a non-empty string representing the user's ID in your database. Value received: ${JSON.stringify(t)}`);this.externalId&&t!==this.externalId&&(h("identify resetting due to new externalId"),this.reset()),this.externalId=t,this.signature=s||null,this.observeUserActivity(),await Promise.all([this.send({kind:"UpsertUser",attributes:this.normalizeAttributes(r)},{batch:!0}),this.onFirstIdentify()]),this.emit("private:identified")}async identifyAnonymous(t={},r={}){if(!ie.isSupported())throw new f("userflow.identifyAnonymous() is not supported when localStorage access is denied.");const s="anonymousId";let i=ie.getItem(s);i||(i="anon-"+Pe(),ie.setItem(s,i)),await this.identify(i,t,r)}getInitToken(){return this.clientToken}getIdentifiedUser(){return{externalId:this.externalId}}async updateUser(t={},r={}){h("updateUser"),this.ensureIdentified(),await this.send({kind:"UpsertUser",attributes:this.normalizeAttributes(t)},{batch:!0})}async group(t,r={},{signature:s,membership:i}={}){if(h("group",t),this.ensureIdentified(),this.testUserIdentified&&t!==this.groupId){h("group() ignored since a test user has been identified");return}if(typeof t=="number")t=String(t);else if(!t||typeof t!="string")throw new f(`userflow.group: First argument must be a non-empty string representing the group's ID in your database. Value received: ${JSON.stringify(t)}`);this.groupId=t,this.groupSignature=s||null,await this.send({kind:"UpsertGroup",groupExternalId:t,groupSignature:this.groupSignature,groupAttributes:this.normalizeAttributes(r),membershipAttributes:this.normalizeAttributes(i)},{batch:!0})}async updateGroup(t={},r={}){h("updateGroup");const s=this.ensureGroup();await this.send({kind:"UpsertGroup",groupExternalId:s,groupSignature:this.groupSignature,membershipAttributes:this.normalizeAttributes(r.membership),groupAttributes:this.normalizeAttributes(t)},{batch:!0})}normalizeAttributes(t){if(t==null)return{};if(typeof t!="object")throw new f("Userflow: 'attributes' must be an object.");const r={};for(const s in t){if(!t.hasOwnProperty(s))continue;if(s==="traits"){const n=t[s];Object.assign(r,this.extractLegacyTraits(n));continue}let i=t[s];if(typeof i=="string"||typeof i=="number"||typeof i=="boolean"||i==null||Array.isArray(i))r[s]=this.normalizeAttributeLiteralOrList(s,i);else{if(typeof i!="object"||i==null)throw new f(`Userflow: Invalid value for '${s}' attribute.`);if("set"in i)r[s]={set:this.normalizeAttributeLiteralOrList(s,i.set),dataType:this.normalizeDataType(s,i.data_type||i.dataType)};else if("set_once"in i||"setOnce"in i)r[s]={setOnce:this.normalizeAttributeLiteralOrList(s,i.set_once??i.setOnce),dataType:this.normalizeDataType(s,i.data_type||i.dataType)};else if("add"in i){const n=i.add;if(typeof n!="string"&&typeof n!="number")throw new f(`Userflow: Invalid 'add' value for '${s}' attribute. Must be a number or string.`);r[s]={add:n}}else if("subtract"in i){const n=i.subtract;if(typeof n!="string"&&typeof n!="number")throw new f(`Userflow: Invalid 'subtract' value for '${s}' attribute. Must be a number or string.`);r[s]={subtract:n}}else if("append"in i)r[s]={append:this.normalizeAttributeLiteralOrList(s,i.append)};else if("prepend"in i)r[s]={prepend:this.normalizeAttributeLiteralOrList(s,i.prepend)};else if("remove"in i)r[s]={remove:this.normalizeAttributeLiteralOrList(s,i.remove)};else throw new f(`Userflow: Invalid value for '${s}' attribute.`)}}return r}normalizeAttributeLiteralOrList(t,r){return Array.isArray(r)?r.map(s=>this.normalizeAttributeLiteral(t,s)):this.normalizeAttributeLiteral(t,r)}normalizeAttributeLiteral(t,r){if(r==null)return null;if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return r;throw new f(`Userflow: Invalid value for '${t}' attribute.`)}normalizeDataType(t,r){if(!r)return null;switch(r){case"string":return y.STRING;case"number":return y.NUMBER;case"boolean":return y.BOOLEAN;case"datetime":return y.DATETIME}throw new f(`Userflow: Invalid data_type for '${t}' attribute.`)}extractLegacyTraits(t){if(!t)return{};if(!Array.isArray(t)){const r=[];for(const s in t)t.hasOwnProperty(s)&&r.push({name:s,value:t[s]});t=r}return t.reduce((r,{name:s,value:i,dataType:n})=>{if(typeof s!="string"||s.length>100||!s.match(/^[a-z0-9_]+$/))return this.warn("Userflow.identify: Invalid trait name (must be string, no more than 100 characters, and only consist of a-z, 0-9 and underscores). The trait will be ignored. Name was:",s),r;if(typeof i!="string")if(typeof i=="boolean")n||(n="boolean"),i=i?"true":"false";else if(typeof i=="number")n||(n=Number.isInteger(i)?"integer":"decimal"),i=String(i);else return this.warn(`userflow.identify: The value of trait '${s}' is invalid (must be a string, a boolean or a number). The trait will be ignored. Value was:`,i),r;let o=null;if(n)switch(n){case"string":o=y.STRING;break;case"boolean":o=y.BOOLEAN;break;case"integer":o=y.NUMBER;break;case"decimal":o=y.NUMBER;break;case"datetime":o=y.DATETIME;break;default:return this.warn(`userflow.identify: The data type of trait '${s}' is invalid (must be a 'string', 'boolean', 'integer', 'decimal' or 'datetime'). The trait will be ignored. Data type was:`,n),r}return r[s]={set:i,dataType:o},r},{})}async track(t,r={},{userOnly:s}={}){h(`track '${t}'`,r),this.ensureIdentified(),await this.send({kind:"TrackEvent",userOnly:!!s,name:t,attributes:this.normalizeEventAttributes(r)},{batch:!0})}async trackRawEvent(t){const{name:r,attributes:s}=t;h(`track raw event '${r}'`,s),this.ensureIdentified(),await this.send({kind:"TrackRawEvent",name:r,attributes:this.normalizeEventAttributes(s)},{batch:!0})}normalizeEventAttributes(t){const r=this.normalizeAttributes(t);for(const s in r){if(!r.hasOwnProperty(s))continue;const i=r[s];if(!(i==null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||Array.isArray(i)||"set"in i))throw new f(`Userflow: Invalid value for '${s}' attribute. Event attributes only support literal values, list values and 'set' changes.`)}return r}onFirstIdentify(){this.onFirstIdentifyRun||(this.onFirstIdentifyRun=!0,this.onFirstIdentifyTimeout=window.setTimeout(()=>{this.trackPageViewed(),this.firstIdentifyCallback?(this.firstIdentifyCallback(),this.firstIdentifyCallback=null):this.checkUrlForStartFlow()},0))}onceIdentified(t){this.isIdentified()?t():this.firstIdentifyCallback=t}checkUrlForStartFlow(){const t=new URL(Br()),r=t.searchParams.get("userflow")||t.searchParams.get("studio1_flow")||t.searchParams.get("studio1_walkthrough");r&&(h(`url contained flow ${r}`),this.startFlow({flowId:r,startReason:ve.LINK,batch:!0}),t.searchParams.delete("userflow"),t.searchParams.delete("studio1_flow"),t.searchParams.delete("studio1_walkthrough"),window.history.replaceState({},"",t.toString()),this.clientContext=this.buildClientContext(),this.pushUpdateClientContext())}flushUrlChange(){const t=this.buildClientContext();(!this.clientContext||t.pageUrl!==this.clientContext.pageUrl)&&(this.clientContext=t,this.pushUpdateClientContext(),this.trackPageViewed(),this.checkUrlForStartFlow())}async trackPageViewed(){this.pageTrackingDisabled||this.track("page_viewed",{}),typeof this.featureFlags>"u"&&this.implicitTrackingQueue.push({id:Pe(),page_title:document.title,...this.buildClientContext()}),this.featureFlagEnabled("cff_implicit_events")===!0&&this.trackRawEvent({name:"page_viewed",attributes:{id:Pe(),page_title:document.title}})}buildClientContext(){return{pageUrl:Xc(),viewportWidth:window.innerWidth,viewportHeight:window.innerHeight}}pushUpdateClientContext(){this.send({kind:"UpdateClientContext",clientContext:this.clientContext},{batch:!0})}ackCompletedTask(t){this.unackedTasks.delete(t)}taskIsUnacked(t){return this.unackedTasks.has(t)}isIdentified(){return this.externalId!=null}on(t,r){let s=this.listeners.get(t);s||(s=new Set,this.listeners.set(t,s)),s.add(r)}off(t,r){const s=this.listeners.get(t);s&&s.delete(r)}emit(t,...r){const s=this.listeners.get(t);s&&Array.from(s).forEach(n=>n(...r))}observeUserActivity(){document.addEventListener("mouseover",this.onUserActivity),document.addEventListener("pointerdown",this.onUserActivity),document.addEventListener("keydown",this.onUserActivity)}unobserveUserActivity(){document.removeEventListener("mouseover",this.onUserActivity),document.removeEventListener("pointerdown",this.onUserActivity),document.removeEventListener("keydown",this.onUserActivity)}reset(){h("reset"),this.externalId=null,this.groupId=null,this.sessionStorageState=null,this.setFlowSession(null,0),this.setChecklistSession(null,0),this.setBannerSession(null),this.setResourceCenterSession(null),this.launcherSessions=[],this.activeLauncherFlowId=null,this.notifications=[],this.unackedTasks=new Set,this.onFirstIdentifyRun=!1,window.clearTimeout(this.onFirstIdentifyTimeout),this.onFirstIdentifyTimeout=void 0,this.clientContext=null,this.unobserveUserActivity(),window.clearTimeout(this.flushUrlChangeTimeout),this.flushUrlChangeTimeout=void 0,this.clientConditions.forEach((t,r)=>{this.untrackClientCondition(r)}),this.firstIdentifyCallback=null,this.testUserIdentified=!1,ie.removeItem("anonymousId"),this.unmountUI(),this.disconnect(),this.inBatch=!1,window.clearTimeout(this.endBatchTimeout),this.endBatchTimeout=void 0,this.clientClock=1,this.serverClock=1,this.titleMonitored=void 0,this.titleObserver&&(this.titleObserver.disconnect(),this.titleObserver=void 0),this.flushImplicitTrackingQueue()}async startFlow({flowId:t,stepCvid:r,startReason:s,once:i,batch:n,replaceCurrent:o}){if(this.ensureIdentified(),o&&this.flowSession&&this.endFlow(this.flowSession,{endReason:le.REPLACED,batch:!0}),h(`startFlow ${t}`,{startReason:s}),this.checklistSession?.flow.id===t){h("startFlow matches current checklist, so showing it instead"),this.showChecklist();return}const a={kind:"StartFlow",flowId:t,stepCvid:r,startReason:s,once:!!i};await this.send(a,{batch:n})}async startFlowWithToken(t){this.ensureIdentified(),h("startFlowWithToken",{token:t}),await this.send({kind:"StartFlowWithToken",token:t},{batch:!0})}optimisticClockUIUpdate(t){this.clientClock++,t(),this.toggleUI()}async showChecklist(){if(this.resourceCenterEmbedsChecklist()){this.openResourceCenter();return}this.unmarkExpandPending(),!(!this.checklistSession||this.checklistExpanded)&&(this.ensureIdentified(),this.checklistExpanded=!0,this.toggleUI(),I.setItem(`checklistExpanded:${this.checklistSession.id}`,"1"),await this.send({kind:"ShowChecklist",sessionId:this.checklistSession.id},{batch:!0}))}async hideChecklist(){if(this.resourceCenterEmbedsChecklist()){this.closeResourceCenter();return}!this.checklistSession||!this.checklistExpanded||(this.ensureIdentified(),this.checklistExpanded=!1,this.toggleUI(),I.removeItem(`checklistExpanded:${this.checklistSession.id}`),await this.send({kind:"HideChecklist",sessionId:this.checklistSession.id},{batch:!0}))}async unmarkExpandPending(){!this.checklistSession||!this.checklistExpandPending||(this.checklistExpandPending=!1,await this.send({kind:"UnmarkExpandPending",sessionId:this.checklistSession.id},{batch:!0}))}async openResourceCenter(){this.resourceCenterEmbedsChecklist()&&this.unmarkExpandPending(),!(!this.resourceCenterSession||this.resourceCenterOpen)&&(this.ensureIdentified(),this.resourceCenterOpen=!0,this.toggleUI(),this.emit("resourceCenterChanged"),I.setItem(`resourceCenterOpen:${this.resourceCenterSession.id}`,"1"),await this.send({kind:"OpenResourceCenter",sessionId:this.resourceCenterSession.id},{batch:!0}))}async closeResourceCenter(){!this.resourceCenterSession||!this.resourceCenterOpen||(this.ensureIdentified(),this.resourceCenterOpen=!1,this.toggleUI(),this.emit("resourceCenterChanged"),I.removeItem(`resourceCenterOpen:${this.resourceCenterSession.id}`),await this.send({kind:"CloseResourceCenter",sessionId:this.resourceCenterSession.id},{batch:!0}))}toggleResourceCenter(){this.resourceCenterOpen?this.closeResourceCenter():this.openResourceCenter()}setResourceCenterLauncherHidden(t){this.resourceCenterLauncherHidden=t,this.toggleUI()}getResourceCenterState(){if(!this.resourceCenterSession)return null;const t=this.resourceCenterEmbedsChecklist(),{checklistSession:r}=this,s=this.resourceCenterSession.version.resourceCenter?.blocks.find(i=>i.type===Ye.ANNOUNCEMENTS);return{isOpen:this.resourceCenterOpen,hasChecklist:t,uncompletedChecklistTaskCount:t&&r?Zc(r):0,unreadAnnouncementCount:s?.unreadAnnouncementCount||0}}resourceCenterEmbedsChecklist(){const t=this.resourceCenterSession;return!!t&&!!t.version.resourceCenter?.blocks.some(r=>r.type===Ye.CHECKLIST)}async endFlow(t,{endReason:r,batch:s}){this.ensureIdentified(),this.optimisticClockUIUpdate(()=>{const{clientClock:a}=this;this.flowSession?.id===t.id&&this.setFlowSession(null,a),this.checklistSession?.id===t.id&&this.setChecklistSession(null,a),this.bannerSession?.id===t.id&&this.setBannerSession(null),this.resourceCenterSession?.id===t.id&&this.setResourceCenterSession(null)});const{flow:i}=t,n={id:i.id,type:i.type.toLowerCase()};i.type===he.CHECKLIST?this.emit("checklistEnded",{checklist:n,endReason:r}):i.type===he.FLOW&&this.emit("flowEnded",{flow:n,endReason:r});const o={kind:"EndFlow",sessionId:t.id,endReason:r};await this.send(o,{batch:s})}async goToStep(t,r){h("goToStep",t.id,r.name||r.id),this.ensureIdentified();const s=this.send({kind:"GoToStep",sessionId:t.id,stepId:r.id});t.currentStep=r,this.emit("gotostep",{session:t,step:r}),await s}async endAllFlows(){h("endAllFlows"),this.optimisticClockUIUpdate(()=>{const{clientClock:t}=this;this.setFlowSession(null,t),this.setChecklistSession(null,t)}),await this.send({kind:"EndAllFlows"})}async endChecklist(){h("endChecklist");const t=this.checklistSession||this.flowSession;t?.flow.type===he.CHECKLIST&&this.endFlow(t,{endReason:le.USERFLOWJS})}setFlowSession(t,r=this.clientClock){const s=this.flowSession;this.flowSession=t,this.flowSessionClock=r,t&&!s&&(this.hideChecklist(),this.closeResourceCenter()),t==null&&this.originalActiveElement&&(typeof this.originalActiveElement.focus=="function"&&this.originalActiveElement.focus(),this.originalActiveElement=void 0)}setChecklistSession(t,r=this.clientClock){const s=this.checklistSession;this.checklistSession=t,this.checklistSessionClock=r,t===null&&(this.checklistExpanded=!1,this.checklistExpandPending=!1),t&&t.id!==s?.id&&(this.checklistExpanded=!!I.getItem(`checklistExpanded:${t.id}`),t.expandPending&&(this.checklistExpandPending=!0)),this.emit("checklistChanged"),this.emit("resourceCenterChanged")}setBannerSession(t){this.bannerSession=t}setResourceCenterSession(t){const r=this.resourceCenterSession;t=typeof t=="function"?t(this.resourceCenterSession):t,this.resourceCenterSession=t,t===null&&(this.resourceCenterOpen=!1),r&&r.id!==t?.id&&I.removeItem(`resourceCenterOpen:${r.id}`),t&&t.id!==r?.id&&(this.resourceCenterOpen=!!I.getItem(`resourceCenterOpen:${t.id}`)),this.emit("resourceCenterChanged")}launcherSeen(t){this.send({kind:"StartFlow",flowId:t,startReason:ve.LAUNCHER_SEEN,once:!1})}activateLauncher(t){const r=this.activeLauncherFlowId&&this.launcherSessions.find(s=>s.flow.id===this.activeLauncherFlowId);r&&this.deactivateLauncher(r),this.activeLauncherFlowId=t.flow.id,this.toggleUI(),this.send({kind:"ActivateLauncher",flowId:t.flow.id})}deactivateLauncher(t){const{launcher:r}=t.version;t.flow.id===this.activeLauncherFlowId&&(r?.dismissOn===Gr.DEACTIVATE?this.dismissLauncher(t,{endReason:le.LAUNCHER_DEACTIVATED}):(this.activeLauncherFlowId=null,this.toggleUI()))}dismissLauncher(t,{endReason:r}){const s=t.flow.id;this.removeLauncher(s),this.toggleUI(),this.send({kind:"DismissLauncher",flowId:s,endReason:r})}removeLauncher(t){const r=this.launcherSessions.findIndex(s=>s.flow.id===t);return r===-1?!1:(this.launcherSessions=[...this.launcherSessions.slice(0,r),...this.launcherSessions.slice(r+1)],t===this.activeLauncherFlowId&&(this.activeLauncherFlowId=null),!0)}async toggleUI(){const t=this.getSessionStorageState();!this.flowSession&&(this.checklistExpandPending||this.checklistSession?.version.checklist?.tasks.some(r=>this.taskIsUnacked(r.cvid)))&&this.showChecklist(),t.isTargetTab&&this.monitorTitle(),this.emit("uistatechange"),this.shouldBeMounted()?await this.mountUI():this.unmountUI()}shouldBeMounted(){return this.uiDisabled?!1:!!this.getSessionStorageState().activeApp||!!this.flowSession||!!this.checklistSession&&(this.checklistExpanded||!!this.checklistSession?.version.checklist?.launcherEnabled)||!!this.bannerSession||!!this.resourceCenterSession&&(this.resourceCenterOpen||!this.resourceCenterLauncherHidden)||this.launcherSessions.length>0||this.notifications.length>0}async mountUI(){if(!this.ui){const t=await this.createUI();this.shouldBeMounted()&&!this.ui&&(h("mount UI"),this.ui=t,this.ui.mount())}}unmountUI(){this.ui&&(h("unmount UI"),this.ui.unmount(),this.ui=null)}checkDebuggerSession(){if(this.debuggerUI)return;const t=this.sessionStorageState?.debuggerApp;t&&t?.x&&t?.y&&this.mountDebugger()}async mountDebugger(){if(this.debuggerUI)return;const{DebuggerUI:t}=await U(async()=>{const{DebuggerUI:r}=await import("./DebuggerUI.v1.BTXD64JU.js");return{DebuggerUI:r}},__vite__mapDeps([17,1,2,8,7,5,6,11,18,9]));this.debuggerUI=new t(this,je),this.debuggerUI.mount()}unMountDebugger(){this.debuggerUI=null}remount(){this.unmountUI(),this.toggleUI()}async createUI(){try{const t=U(()=>import("./ui.v1.DH9JjGAA.js"),__vite__mapDeps([19,1,2]));this.bannerSession&&qc(),this.resourceCenterSession&&Qc();const{RealUI:r}=await t;return new r(this)}catch(t){throw this.reportCspIssue(),t}}async trackClientCondition(t){if(this.clientConditions.has(t.id))return;h("track client condition",t),this.clientConditions.set(t.id,{condition:t,isTrue:null});const{conditionTypes:r}=await U(async()=>{const{conditionTypes:n}=await import("./flow-condition-types.v1.ByaBzkSZ.js").then(o=>o.j);return{conditionTypes:n}},__vite__mapDeps([5,2,6])),s=r[t.type],i=this.clientConditions.get(t.id);i&&(i.untrack=s.track({sessionData:new Vt([]),condition:t,callback:n=>{i.isTrue!==n&&(h("client condition truthiness changed",n,i.condition),i.isTrue=n,this.send({kind:"ToggleClientCondition",conditionId:t.id,isTrue:n},{batch:!0}))}}))}untrackClientCondition(t){const r=this.clientConditions.get(t);r&&(h("untrack client condition",r.condition),r.untrack&&r.untrack(),this.clientConditions.delete(t))}async addTracker(t){let r=this.trackers.get(t.flowId);r?r.tracker=t:this.trackers.set(t.flowId,{tracker:t,isTrue:!1});const{conditionTypes:s}=await U(async()=>{const{conditionTypes:c}=await import("./flow-condition-types.v1.ByaBzkSZ.js").then(l=>l.j);return{conditionTypes:c}},__vite__mapDeps([5,2,6])),i=this.trackers.get(t.flowId);if(!i)return;const{tracker:n}=i,{condition:o}=n,a=s[o.type];i.untrack&&i.untrack(),i.untrack=a.track({sessionData:new Vt(n.data),condition:o,flipBackEvents:!0,callback:c=>{const l=i.isTrue;i.isTrue=c,!l&&c&&this.send({kind:"TrackTrackerEvent",token:n.token},{batch:!0})},description:`event tracker ${n.flowId}`}),this.emit("private:trackerStarted")}removeTracker(t){const r=this.trackers.get(t);r&&(r.untrack&&r.untrack(),this.trackers.delete(t),this.emit("private:trackerStopped"))}monitorTitle(){if(this.titleMonitored)return;this.titleMonitored=!0,this.fixTitle();const t=document.querySelector("title");if(t){const r=new MutationObserver(()=>{this.fixTitle()});r.observe(t,{childList:!0}),this.titleObserver=r}}fixTitle(){const t=document.title,s="[Userflow Preview] "+t.replace(/\[Userflow Preview\] /,"");t!==s&&(document.title=s)}reportCspIssue(){const t=this.getSessionStorageState();(this.testUserIdentified||t.activeApp)&&!this.cspIssueReported&&(this.cspIssueReported=!0,h("csp issue detected"),ze({kind:"userflow:crxCspIssueDetected"}))}getAudio(){return this.audio||(this.audio=new Audio),this.audio}playAudio(t){if(document.hidden)return;const r=this.getAudio();t&&(r.src=t);const s=r.play();this.audioReady=!0,s&&s.catch(i=>{i.name})}pauseAudio(){const t=this.audio;t&&!t.paused&&t.pause()}async getStepSpeech(t,r){return(await this.send({kind:"GetStepSpeechV2",syntheticVoice:t,text:r})).url}featureFlagEnabled(t){return this.featureFlags?this.featureFlags.has(t):!1}showNotification(t,r,s){const n={id:++this.notificationIdCounter,label:t,message:r,type:s};this.notifications=[...this.notifications,n],this.toggleUI()}dismissNotification(t){this.notifications=this.notifications.filter(r=>r.id!==t),this.toggleUI()}warn(...t){console.warn(...t)}nextRef(){return this.refCounter++}}if(typeof window.userflow>"u"||window.userflow._stubbed){const e=Object.assign(window.userflow||{},sl());window.userflow=e,window.studio1=e,il()}function sl(){const e=new rl;return{_stubbed:!1,init(t){e.init(t)},identify(t,r={},s={}){return e.identify(t,r,s)},identifyAnonymous(t={},r={}){return e.identifyAnonymous(t,r)},isIdentified(){return e.isIdentified()},updateUser(t,r={}){return e.updateUser(t,r)},group(t,r={},s={}){return e.group(t,r,s)},updateGroup(t,r={}){return e.updateGroup(t,r)},track(t,r={},s={}){return e.track(t,r,s)},start(t,{once:r}={}){return e.startFlow({flowId:t,startReason:ve.USERFLOWJS,once:r})},startFlow(t){return console.warn("Userflow.js: userflow.startFlow() has been deprecated. Use userflow.start() instead."),window.userflow.start(t)},startWalk(t){return console.warn("Userflow.js: userflow.startWalk() has been deprecated. Use userflow.start() instead."),window.userflow.start(t)},endAll(){return e.endAllFlows()},endChecklist(){return e.endChecklist()},endAllFlows(){"Userflow.js: userflow.endAllFlows() has been deprecated. Use userflow.endAll() instead.";return window.userflow.endAll()},async endFlow(){console.warn("Userflow.js: userflow.endFlow() has been deprecated and no longer has any effect.")},async endWalk(){console.warn("Userflow.js: userflow.endWalk() has been deprecated and no longer has any effect.")},openResourceCenter(){e.openResourceCenter()},closeResourceCenter(){e.closeResourceCenter()},toggleResourceCenter(){e.toggleResourceCenter()},setResourceCenterLauncherHidden(t){e.setResourceCenterLauncherHidden(t)},getResourceCenterState(){return e.getResourceCenterState()},setWalkPosition(){console.warn("Userflow.js: userflow.setWalkPosition() has been deprecated and no longer has any effect.")},reset(){e.reset()},remount(){e.remount()},on(t,r){e.on(t,r)},off(t,r){e.off(t,r)},setCustomInputSelector(t){console.warn("Userflow.js: userflow.setCustomInputSelector() has been deprecated. Use userflow.registerCustomInput() instead. See docs: https://userflow.com/docs/userflow-js"),t&&g.customInputs.push({cssSelector:t})},registerCustomInput(t,r){g.customInputs.push({cssSelector:t,getValue:r})},setCustomNavigate(t){g.customNavigate=t},setUrlFilter(t){g.urlFilter=t},setLinkUrlDecorator(t){g.linkUrlDecorator=t,e.emit("uistatechange")},setInferenceAttributeNames(t){g.inferenceAttributeNames=t},setInferenceAttributeFilter(t,r){g.inferenceAttributeFilters[t]=Kt(r)},setInferenceClassNameFilter(t){g.inferenceClassNameFilters=Kt(t)},setScrollPadding(t){g.scrollPadding=t},setCustomScrollIntoView(t){g.customScrollIntoView=t},prepareAudio(){e.playAudio(null)},setShadowDomEnabled(t){console.warn("Userflow.js: userflow.setShadowDomEnabled() has been deprecated. Please remove this call from your Userflow.js snippet. Shadow DOM is supported by default now.")},setPageTrackingDisabled(t){e.pageTrackingDisabled=t},setBaseZIndex(t){g.baseZIndex=t},setServerEndpoint(t){g.serverEndpoint=t},disableEvalJs(){g.evalJsDisabled=!0},_setTargetEnv(t){e.setTargetEnv(t)},_getInitToken(){return e.getInitToken()},_getIdentifiedUser(){return e.getIdentifiedUser()},debugger(){e.mountDebugger()}}}function il(){const e=window.userflow,t=window.USERFLOWJS_QUEUE;if(delete window.USERFLOWJS_QUEUE,!(!t||t.length===0)){h(`processing ${t.length} items in the queue`);for(const[r,s,i]of t){if(typeof e[r]!="function"){console.error(`Userflow.js: Invalid method '${r}' in queue`);continue}const n=e[r](...i);s&&n&&typeof n.then=="function"&&n.then(s.resolve,s.reject)}h("queue processed")}}export{Bc as $,y as A,qc as B,Ac as C,Fc as D,le as E,ac as F,cc as G,wc as H,pc as I,ie as J,_c as K,vc as L,mc as M,Tc as N,Wc as O,Ic as P,Hc as Q,Qc as R,uc as S,bc as T,f as U,Rc as V,Vc as W,Mc as X,jc as Y,Gc as Z,U as _,he as a,xc as a0,kc as a1,gc as a2,ol as a3,Br as a4,Uc as a5,Lc as a6,Sc as a7,Xc as a8,tc as a9,Hr as aa,hc as ab,al as ac,zt as ad,zc as ae,nc as af,fc as b,dc as c,h as d,ic as e,J as f,nl as g,lc as h,Kc as i,oc as j,Ec as k,Vt as l,Ye as m,g as n,Zc as o,yc as p,Cc as q,Pc as r,Oc as s,Nc as t,I as u,Pe as v,$c as w,ve as x,Yc as y,Dc as z};
//# sourceMappingURL=userflow.js.map
